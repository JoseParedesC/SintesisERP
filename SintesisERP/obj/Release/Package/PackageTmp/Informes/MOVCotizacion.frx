<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="11/22/2017 13:45:19" ReportInfo.Modified="01/07/2021 10:44:42" ReportInfo.CreatorVersion="2017.4.6.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    private void Picture1_AfterData(object sender, EventArgs e)
    {                    
      companyimg.ImageLocation = ((String)Report.GetColumnValue(&quot;CabeceraEmpresa.urlimg&quot;));
    }   
    
    
    private void MasterData1_BeforePrint(object sender, EventArgs e)
    { 
      bool visible = false;
      /*if (!Report.GetColumnValue(&quot;ReportBody.serie&quot;).Equals(&quot;&quot;)){
        serie.Text = &quot;&lt;b&gt;Serie: &lt;/b&gt;&quot; + Report.GetColumnValue(&quot;ReportBody.serie&quot;).ToString()+ &quot;       &quot;;
        visible = true;
      }
        
      if (!Report.GetColumnValue(&quot;ReportBody.lote&quot;).Equals(&quot;&quot;)) {      
        serie.Text += &quot;&lt;b&gt;Lote: &lt;/b&gt; &quot; + Report.GetColumnValue(&quot;ReportBody.vencimiento&quot;).ToString();        
        visible = true;
      }
      
      serie.Visible = visible;                  
*/
    }
  }
}
</ScriptText>
  <Styles>
    <Style Name="MarcosDetalle" Fill.Color="138, 220, 220, 220"/>
  </Styles>
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqN3m3PA5vTWXdgYxRusNWXH0P5myR1WW+esAlhBSMeff3iOWHUexZln4Jn9vpJMdDoSOTPk7DcQEPBdcWx/mGSkrYV+aRLiR6AXgZ6svgJduf978IrXbsEF8FdNltTZzxQrKtG6as0MeSkhLCnS7HvQjvmSjFFAIeN+g1otzyaj1yJif0/NEjbIv9y07Tjjr1Vy1LVcqN8tZxIlO+poO5i9gVuqw2JFUjwaFLNQmDF30=">
      <TableDataSource Name="Table" Alias="CabeceraEmpresa" DataType="System.Int32" Enabled="true" SelectCommand="SET FMTONLY OFF;  Exec [dbo].[ST_Rpt_CabeceraCompania] @id_caja = @id_caja, @id_user = @id_user">
        <Column Name="nombre" DataType="System.String"/>
        <Column Name="nit" DataType="System.String"/>
        <Column Name="digito" DataType="System.String"/>
        <Column Name="direccion" DataType="System.String"/>
        <Column Name="telefono" DataType="System.String"/>
        <Column Name="usuario" DataType="System.String"/>
        <Column Name="urlimg" DataType="System.String"/>
        <CommandParameter Name="@id_caja" DataType="8" Expression="id_caja" DefaultValue="0"/>
        <CommandParameter Name="@id_user" DataType="8" Expression="id_user" DefaultValue="1"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="ReportBody" DataType="System.Int32" Enabled="true" SelectCommand="SET FMTONLY OFF;  Exec [Dbo].[ST_Rpt_MovCotizacion] @id = @id, @op = 'B'">
        <Column Name="cantidad" DataType="System.Decimal"/>
        <Column Name="codigo" DataType="System.String"/>
        <Column Name="nombre" DataType="System.String"/>
        <Column Name="precio" DataType="System.Decimal"/>
        <Column Name="iva" DataType="System.Decimal"/>
        <Column Name="descuento" DataType="System.Decimal"/>
        <Column Name="total" DataType="System.Decimal"/>
        <CommandParameter Name="@id" DataType="8" Expression="id" DefaultValue="3"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="ReportHead" DataType="System.Int32" Enabled="true" SelectCommand="SET FMTONLY OFF;  Exec [Dbo].[ST_Rpt_MovCotizacion] @id = @id, @op = 'C'">
        <Column Name="id" DataType="System.Int64"/>
        <Column Name="estado" DataType="System.String"/>
        <Column Name="iva" DataType="System.Decimal"/>
        <Column Name="descuento" DataType="System.Decimal"/>
        <Column Name="fechacot" DataType="System.String"/>
        <Column Name="subtotal" DataType="System.Decimal"/>
        <Column Name="total" DataType="System.Decimal"/>
        <Column Name="cliente" DataType="System.String"/>
        <Column Name="vendedor" DataType="System.String"/>
        <Column Name="turno" DataType="System.String"/>
        <Column Name="username" DataType="System.String"/>
        <Column Name="bodega" DataType="System.String"/>
        <CommandParameter Name="@id" DataType="8" Expression="id" DefaultValue="3"/>
      </TableDataSource>
    </MsSqlDataConnection>
    <Parameter Name="id_caja" DataType="System.Int32"/>
    <Parameter Name="id" DataType="System.Int32"/>
    <Parameter Name="id_user" DataType="System.Int32"/>
  </Dictionary>
  <ReportPage Name="Page1" RawPaperSize="9" LeftMargin="5" RightMargin="5" BottomMargin="5" FirstPageSource="15" OtherPagesSource="15" Guides="746.55,746.55,746.55,746.55,756,756,756,-18.9,718.2">
    <ReportTitleBand Name="ReportTitle1" Width="756" Height="162.54" Border.ShadowWidth="1" Border.ShadowColor="Silver">
      <TextObject Name="Compania" Width="759.69" Height="22.68" Text="[CabeceraEmpresa.nombre]" Padding="2, 1, 2, 1" HorzAlign="Center" Font="Arial Narrow, 11pt, style=Bold"/>
      <TextObject Name="LNit" Left="4.73" Top="18.9" Width="750.24" Height="18.9" Text="NIT: [CabeceraEmpresa.nit]" Padding="2, 1, 2, 1" HorzAlign="Center" Font="Arial Narrow, 10pt"/>
      <TextObject Name="Text71" Left="-75.6" Top="68.04" Width="907.2" Height="18.9" Text="COTIZACION" Padding="2, 1, 2, 1" HorzAlign="Center" Font="Arial Narrow, 11pt, style=Bold, Italic"/>
      <TextObject Name="Text72" Top="34.02" Width="759.69" Height="28.35" Text="Tel: [CabeceraEmpresa.direccion]" Padding="2, 1, 2, 1" HorzAlign="Center" Font="Arial Narrow, 10pt"/>
      <PictureObject Name="companyimg" Left="28.35" Top="-9.45" Width="103.95" Height="85.05" AfterDataEvent="Picture1_AfterData" SizeMode="StretchImage"/>
      <TextObject Name="Text117" Top="49.14" Width="759.69" Height="28.35" Text="[CabeceraEmpresa.telefono]" Padding="2, 1, 2, 1" HorzAlign="Center" Font="Arial Narrow, 10pt"/>
      <TextObject Name="Text106" Left="232.47" Top="103.95" Width="99.79" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Fecha Impresión:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text107" Top="103.95" Width="109.62" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="N° Cotizacion:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text108" Left="332.26" Top="103.95" Width="151.58" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[Date]" Format="Custom" Format.Format="yyyy-MM-dd HH:mm" VertAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text132" Left="109.62" Top="103.95" Width="122.85" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.id]" VertAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text124" Top="119.07" Width="109.62" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Fecha Documento:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text125" Left="109.62" Top="119.07" Width="122.85" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.fechacot]" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text126" Left="483.84" Top="119.07" Width="94.5" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Vendedor:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text127" Left="577.96" Top="119.07" Width="177.66" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.vendedor]" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt"/>
      <TextObject Name="Text133" Left="483.84" Top="103.95" Width="94.5" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Estado:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text134" Left="577.96" Top="103.95" Width="177.66" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.estado]" Format="Custom" Format.Format="yyyy-MM-dd HH:mm" VertAlign="Center" Font="Arial, 8pt"/>
      <LineObject Name="Line1" Top="94.5" Width="756" Border.Color="Gray" Border.Width="0"/>
      <TextObject Name="Text148" Left="232.47" Top="119.07" Width="99.79" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Bodega:" Padding="2, 1, 2, 1" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text149" Left="332.26" Top="119.07" Width="151.58" Height="15.12" Border.Lines="All" Border.Color="DarkGray" CanBreak="false" Text="[ReportHead.bodega]" Padding="2, 1, 2, 0" VertAlign="Center" WordWrap="false" Font="Arial, 8pt"/>
      <TextObject Name="Text130" Top="134.19" Width="109.62" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Cliente:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text131" Left="109.62" Top="134.19" Width="645.62" Height="15.12" Border.Lines="All" Border.Color="DarkGray" CanBreak="false" Text="[ReportHead.cliente]" Format="Custom" Format.Format="yyyy-MM-dd HH:mm" VertAlign="Center" WordWrap="false" Font="Arial, 8pt"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="166.54" Width="756" Height="22.68">
      <TextObject Name="Text59" Top="3.78" Width="69.9" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Código" Padding="2, 1, 2, 1" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text83" Left="417.69" Top="3.78" Width="88.8" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Precio UND" Padding="2, 1, 2, 1" HorzAlign="Right" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Left="506.52" Top="3.78" Width="88.83" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Iva/Und" Padding="2, 1, 2, 1" HorzAlign="Right" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text120" Left="595.35" Top="3.78" Width="69.9" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Dcto" Padding="2, 1, 2, 1" HorzAlign="Right" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text103" Left="328.86" Top="3.78" Width="41.55" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Cant" Padding="2, 1, 2, 1" HorzAlign="Right" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text90" Left="665.28" Top="3.78" Width="88.4" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Total" Padding="2, 1, 2, 1" HorzAlign="Right" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text146" Left="69.93" Top="3.78" Width="258.9" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Nombre" Padding="2, 1, 2, 1" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text162" Left="370.44" Top="3.78" Width="47.25" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Inc" Padding="2, 1, 2, 1" HorzAlign="Right" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="193.22" Width="756" Height="18.9" CanGrow="true" EvenStylePriority="UseAll" BeforePrintEvent="MasterData1_BeforePrint" DataSource="Table1">
      <TextObject Name="Text65" Top="3.78" Width="69.93" Height="15.12" Anchor="Top" CanGrow="true" GrowToBottom="true" CanBreak="false" Text="[ReportBody.codigo]" Padding="2, 1, 2, 0" Font="Arial, 8pt"/>
      <TextObject Name="Text91" Left="676.68" Top="3.78" Width="79.29" Height="15.12" GrowToBottom="true" CanBreak="false" Text="[ReportBody.total]" Padding="2, 1, 2, 0" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text84" Left="417.52" Top="3.78" Width="90.72" Height="15.12" GrowToBottom="true" CanBreak="false" Text="[ReportBody.precio]" Padding="2, 1, 2, 0" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text119" Left="510.3" Top="3.78" Width="90.72" Height="15.12" GrowToBottom="true" CanBreak="false" Text="[ReportBody.iva]" Padding="2, 1, 2, 0" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text121" Left="599.13" Top="3.78" Width="71.82" Height="15.12" GrowToBottom="true" CanBreak="false" Text="[ReportBody.descuento]" Padding="2, 1, 2, 0" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="0" Format.NegativePattern="1" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text147" Left="67.66" Top="3.78" Width="264.6" Height="15.12" CanGrow="true" GrowToBottom="true" CanBreak="false" Text="[ReportBody.nombre]" Padding="2, 1, 2, 0" Font="Arial, 8pt"/>
      <TextObject Name="serie" Top="17.01" Width="759.78" Anchor="Top" Visible="false" CanGrow="true" GrowToBottom="true" CanBreak="false" Padding="2, 1, 2, 0" Font="Arial, 8pt" HtmlTags="true"/>
      <TextObject Name="Text161" Left="330.75" Top="3.78" Width="39.69" Height="15.12" GrowToBottom="true" CanBreak="false" Text="[ReportBody.cantidad]" Padding="2, 1, 2, 0" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text163" Left="368.55" Top="3.78" Width="49.14" Height="15.12" GrowToBottom="true" CanBreak="false" Padding="2, 1, 2, 0" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" Font="Arial, 8pt"/>
    </DataBand>
    <ReportSummaryBand Name="ReportSummary1" Top="216.12" Width="756" Height="94.5">
      <TextObject Name="Text111" Left="519.75" Top="49.14" Width="113.4" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Iva:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text112" Left="519.75" Top="34.02" Width="113.4" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Descuento:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text136" Left="633.15" Top="49.14" Width="122.85" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.iva]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="2" Format.NegativePattern="12" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text137" Left="633.15" Top="34.02" Width="122.85" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.descuento]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="2" Format.NegativePattern="12" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text144" Left="519.75" Top="18.9" Width="113.4" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Subtotal:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text145" Left="633.15" Top="18.9" Width="122.85" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.subtotal]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="2" Format.NegativePattern="12" HorzAlign="Right" Font="Arial, 8pt"/>
      <TextObject Name="Text113" Left="519.75" Top="64.26" Width="113.4" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Fill.Color="121, 220, 220, 220" Text="Total Cotizacion:" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text139" Left="633.15" Top="64.26" Width="122.85" Height="15.12" Border.Lines="All" Border.Color="DarkGray" Text="[ReportHead.total]" Format="Currency" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator="," Format.CurrencySymbol="$" Format.PositivePattern="2" Format.NegativePattern="12" HorzAlign="Right" Font="Arial, 8pt, style=Bold"/>
    </ReportSummaryBand>
    <PageFooterBand Name="PageFooter1" Top="314.62" Width="756" Height="94.5">
      <TextObject Name="Text54" Left="523.53" Top="56.7" Width="223.02" Height="15.12" Text="Página [Page#] de [TotalPages#]" HorzAlign="Right"/>
      <TextObject Name="Text105" Left="9.45" Top="66.15" Width="274.05" Height="18.9" Text="Realizado por Sintesis Tecnologia" Format="Custom" Format.Format="yyyy/MM/dd HH:mm" Font="Arial, 10pt, style=Bold"/>
      <LineObject Name="Line5" Left="9.45" Top="28.35" Width="274.05" Border.Width="2"/>
      <TextObject Name="Text2" Left="9.45" Top="28.35" Width="274.05" Height="18.9" Text="Impreso Por" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt, style=Bold"/>
      <TextObject Name="Text1" Left="9.45" Top="9.45" Width="274.05" Height="18.9" Text="[CabeceraEmpresa.usuario]" HorzAlign="Center" VertAlign="Center"/>
    </PageFooterBand>
  </ReportPage>
</Report>
